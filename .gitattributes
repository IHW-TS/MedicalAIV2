# Auto detect text files and perform LF normalization
* text=auto


function main(workbook: ExcelScript.Workbook) {
    let sheet = workbook.getActiveWorksheet();
    let usedRange = sheet.getUsedRange();

    if (usedRange) {
        let formulas = usedRange.getFormulas();  // Récupère les formules

        for (let i = 0; i < formulas.length; i++) {
            for (let j = 0; j < formulas[i].length; j++) {
                if (typeof formulas[i][j] === "string" && formulas[i][j].includes("#REF!")) {
                    // Remplace #REF! dans la formule en forçant une correction
                    formulas[i][j] = `SIERREUR(${formulas[i][j].replace("#REF!", "0")},0)`;
                }
            }
        }

        usedRange.setFormulas(formulas);  // Applique les nouvelles formules
    }
}